<?php
if (!defined('BASEPATH')) exit('No direct script access allowed');class Authenticate extends MX_Controller { public function __construct() { parent::__construct(); } private function get_module() { return 'authenticate'; } private function get_table_name() { return 'user'; } public function index() { $_d0e68c0d79f2['module'] = $this->get_module(); $_d0e68c0d79f2['view_file'] = 'login_view'; $_d0e68c0d79f2['menu_view'] = 'login'; $_d0e68c0d79f2['title'] = "Halaman Login"; $this->load->view('login_view', $_d0e68c0d79f2); } public function login() { $_68e3e4f488f8 =& $this->pro_database; $_d8d2d95816b8 = $this->input->post(); $_011233765f55 = md5($_d8d2d95816b8['pass']).sha1($_d8d2d95816b8['pass']); $_011233765f55=sha1($_011233765f55); $_7cb9a1aed56a = array('username' => $_d8d2d95816b8['uname'], 'password' => $_011233765f55, 'status' => 1); $_c5a08fe9d0d0 = $_68e3e4f488f8->find(array( 'table' => $this->get_table_name(), 'where' => $_7cb9a1aed56a, 'field' => array('id', 'username', 'name', 'type','email','avatar'), 'limit' => 1)); if (!empty($_c5a08fe9d0d0)) { $_c5a08fe9d0d0 = $_c5a08fe9d0d0->row_array(); $this->session->set_userdata(array( 'name' => $_c5a08fe9d0d0['name'], 'username' => $_c5a08fe9d0d0['username'], 'user_id' => $_c5a08fe9d0d0['id'], 'type' => $_c5a08fe9d0d0['type'], 'email' => $_c5a08fe9d0d0['email'], 'avatar' => empty($_c5a08fe9d0d0['avatar'])?base_url().'assets/img/profile.jpg':$_c5a08fe9d0d0['avatar'], 'logged_in' => true, )); $_d74f57261e32 = base_url() . 'home'; } else { $this->session->set_flashdata('error_message', 'User atau Password tidak ditemukan'); $_d74f57261e32 = base_url() . 'authenticate'; } redirect($_d74f57261e32); } public function logout() { $this->session->sess_destroy(); redirect(base_url()); } }